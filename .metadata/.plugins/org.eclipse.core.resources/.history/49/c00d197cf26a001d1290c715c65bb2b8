<!DOCTYPE html>
<html>
<head>
<meta charset="EUC-KR">
<title>Insert title here</title>
<script type="text/javascript">
let cnt = 1;//글번호. 글 한개 작성하는 div의 id

const mkDiv = (num, name, content) => {
	let newEl = document.createElement("div");
	newEl.setAttribute("id", "div_"+num);
	newEl.setAttribute("naAttr", name);
	newEl.setAttribute("contAttr", content);
	
	newEl.style.border = "1px solid black";
	let txt = "";
	txt += "writer:"+name+"<br/>";
	txt += "content:"+content+"<br/>";
	txt += "<input type='button' value='수정' onclick='editf("+num+")'>";
	txt += "<input type='button' value='삭제' onclick='del("+num+")'>";
	newEl.innerHTML = txt;
	return newEl;
}
const addBoard = () => {
	let num = cnt;
	let name = addForm.writer.value;//작성자 입력값
	let cont = addForm.content.value;//글내용 입력값
	let listDiv = document.getElementById("list");
	let child = mkDiv(num, name, cont);
	listDiv.appendChild(child);
	//폼양식 초기화
	addForm.writer.value = "";
	addForm.content.value = "";
	cnt++;
}

const del = (num) => {
	//alert(num);
	let listDiv = document.getElementById("list");
	let delDiv = document.getElementById("div_"+num);
	//alert(delDiv.innerHTML);
	listDiv.removeChild(delDiv);
}

const editf = (num) => {
	//수정폼을 보여줄 div 추출
	let editDiv = document.getElementById("div_"+num);
	//수정폼 추출
	let name = editDiv.getAttribute("naAttr");
	let cont = editDiv.getAttribute("contAttr");
	let eForm = document.getElementById("editForm");
	editForm.writer.value = name;
	editForm.content.value = cont;
	editForm.n.value = num;
	editDiv.appendChild(eForm);
	eForm.style.display = '';
}

const cancel = () => {
	//body 요소 추출
	let body = document.getElementsByTagName("body")[0];
	//수정폼 추출
	let eForm = document.getElementById("editForm");
	//body의 자식으로 되돌아 감
	body.appendChild(eForm);
	//화면에 안보이게 설정
	eForm.style.display = 'none';
	editForm.writer.value = "";
	editForm.content.value = "";
}

const edit = () => {
	let num = editForm.n.value;
	let oldDiv = document.getElementById("div_"+num);
	let name = editForm.writer.value;//작성자 입력값
	let cont = editForm.content.value;//글내용 입력값
	cancel();
	let listDiv = document.getElementById("list");
	let newDiv = mkDiv(num, name, cont);
	listDiv.replaceChild(newDiv, oldDiv);
}
</script>
</head>
<body>
	<h3>실시간 댓글</h3>
	<form action="" name="addForm">
		<table border="1">
			<tr>
				<th>작성자</th>
				<td><input type="text" name="writer"></td>
			</tr>
			<tr>
				<th>내용</th>
				<td><input type="text" name="content"></td>
			</tr>
			<tr>
				<th>저장</th>
				<td><input type="button" value="작성" onclick="addBoard()"></td>
			</tr>
		</table>
	</form>
	<h3>글목록</h3>
	<div id="list">
	</div>
	
	<form action="" id="editForm" name="editForm" style="display:none">
		<table border="1">
			<tr>
				<th>작성자</th>
				<td><input type="text" name="writer"></td>
			</tr>
			<tr>
				<th>내용</th>
				<td><input type="text" name="content"></td>
			</tr>
			<tr>
				<th>수정</th>
				<td>
					<input type="button" value="수정" onclick="edit()">
					<input type="button" value="취소" onclick="cancel()">
					<input type="hidden" name="n">
				</td>
			</tr>
		</table>
	</form>
</body>
</html>